import json

items = {}

def lambda_handler(event, context):
    http_method = event['httpMethod']
    path = event['path']

    if path == '/items':
        if http_method == 'GET':
            return {
                "statusCode": 200,
                "headers": {"Content-Type": "application/json"},
                "body": json.dumps(list(items.values()))
            }
        elif http_method == 'POST':
            try:
                body = json.loads(event['body'])
                item_id = str(len(items) + 1)
                items[item_id] = {"id": item_id, **body}
                return {
                    "statusCode": 201,
                    "headers": {"Content-Type": "application/json"},
                    "body": json.dumps(items[item_id])
                }
            except (json.JSONDecodeError, TypeError):
                return {"statusCode": 400, "body": json.dumps({"error": "Invalid request body"})}
        else:
            return {"statusCode": 405, "body": json.dumps({"error": "Method Not Allowed"})}
    else:
        return {"statusCode": 404, "body": json.dumps({"error": "Not Found"})}